<template>
    <div class="slds-is-relative">
        <div if:true={showError} class="error">
            <lightning-icon icon-name="utility:error" size="small" variant="inverse"></lightning-icon>
            {errorMessage}
        </div>
        <lightning-spinner if:true={isLoading} variant="brand"></lightning-spinner>

        <p class="main-text">
            {LABELS.creditCards}
            <lightning-button
                disabled={processing}
                label={LABELS.newCreditCard}
                onclick={handleAddNewCard}
                variant="neutral">
            </lightning-button>
        </p>
        <template if:true={dataFound}>
            <lightning-radio-group name="radioGroup"
                label="Payment Methods"
                variant="label-hidden"
                disabled={processing}
                options={options}
                onchange={handleSelectPaymentMethod}
                type="radio">
            </lightning-radio-group>
        </template>
        <template if:false={dataFound}>
            <p>{LABELS.thereAreNoSavedCreditCardsYet}</p>
        </template>

        <div class="billing-address slds-m-top_small">
            <div class="slds-text-heading_small slds-m-bottom_small"> Billing Address</div>
            <lightning-input 
                type="checkbox" 
                checked={useShippingAddress} 
                label="Same as shipping address" 
                onclick={handleSwitchAddress}>
            </lightning-input>

            <template if:false={useShippingAddress}>
                <lightning-input-address
                    variant="label-hidden"
                    address-label="Address"
                    street-label="Street"
                    city-label="City"
                    country-label="Country"
                    province-label="State"
                    postal-code-label="PostalCode"
                    street={billingAddress.street}
                    city={billingAddress.city}
                    country={billingAddress.country}
                    province={billingAddress.state}
                    postal-code={billingAddress.postalCode}
                    country-options={countryOptions}
                    province-options={stateOptions}
                    onchange={handleChangeAddress} >
                </lightning-input-address>
            </template>
        </div>
    </div>

    <!-- CARD MODAL -->
    <c-b2b-modal-window data-id={cardModalWindowId}>
        <c-b2b-add-new-card
            field-css="slds-col slds-wrap slds-grid slds-size_1-of-1"
            header-label={LABELS.newCreditCard}
            validate-in-place="true"
            account-id={effectiveAccountId}
            onclosecardmodal={handleCardClose}
            onnewcardadded={handleNewCardAdded}>
        </c-b2b-add-new-card>
    </c-b2b-modal-window>

</template>
